{% assign article_title = page.title | escape %}
{% assign article_url = site.url | append: page.url %}

{% if page.description %}
{% assign article_description = page.description | strip_html | strip_newlines %}
{% else %}
{% assign article_description = site.description %}
{% endif %}

{% if page.image %}
{% assign article_image = page.image %}
{% else %}
{% assign article_image = site.share_image_url %}
{% endif %}

{% if page.author %}
{% assign article_author = page.author %}
{% else %}
{% assign article_author = site.author %}
{% endif %}

{% if page.canonical %}
<link rel="canonical" href="{{ page.canonical }}">
{% endif %}

<!-- Article-specific metadata -->
<meta name="description" content="{{ article_description }}">
<meta name="keywords" content="{{ page.keywords }}">
<meta name="article-author" content="{{ article_author }}">

<!-- Open Graph metadata -->
<meta property="og:title" content="{{ article_title }}">
<meta property="og:description" content="{{ article_description }}">
<meta property="og:image" content="{{ article_image }}">
<meta property="og:site_name" content="{{ site.publisher }}">
<meta property="og:url" content="{{ article_url }}">

{% if page.layout == "detail" %}
<meta property="og:type" content="article">
<meta property="article:publisher" content="https://www.facebook.com/{{ site.facebook_username }}/">
<meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
{% else %}
<meta property="og:type" content="website">
{% endif %}

<meta property="fb:app_id" content="{{ site.facebook_app_id }}">

<!-- Twitter Card metadata -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url" content="{{ article_url }}">
<meta name="twitter:title" content="{{ article_title }}">
<meta name="twitter:description" content="{{ article_description }}">
<meta name="twitter:image" content="{{ article_image }}">
<meta name="twitter:site" content="@{{ site.twitter_username }}">

<meta name="theme-color" content="#438aff">

{% if page.layout == "detail" %}
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "mainEntityOfPage": "{{ article_url }}",
  "headline": "{{ article_title }}",
  "datePublished": "{{ page.date | date_to_xmlschema }}",
  "dateModified": "{{ page.lastmod | date_to_xmlschema }}",
  "publisher": {
    "@type": "Organization",
    "name": "{{ site.publisher }}",
    "logo": {
        "@type": "ImageObject",
        "url": "{{ site.publisher_logo }}",
        "width": "200",
        "height": "200"
    }
  },
  "author": {
    "@type": "Person",
    "name": "{{ article_author }}"
  },
  "image": {
    "@type": "ImageObject",
    "url": "{{ article_image }}",
    "width": 1200,
    "height": 630
  }
}
</script>
{% endif %}
